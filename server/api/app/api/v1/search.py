import json

from flask import abort, jsonify, request
from numpy import dot
from numpy.linalg import norm

from . import api

# Mocks

products = {
    "book/1": {
        "id": "book/1",
        "type": "book",
        "title": "Создавая и ломая сетку",
        "author": "Тимоти Самара",
        "average_price": 2465,
        "currency": "rub",
        "rating": 4.5,
        "img_url": "https://ozon-st.cdn.ngenix.net/multimedia/1000233363.jpg",
        "details": [
            {
                "type": "stores",
                "title": "Продается в магазинах",
                "stores": [
                    {
                        "id": 1,
                        "name": "Ozon.ru",
                        "img_url": "https://ozon-st.cdn.ngenix.net/multimedia/1000233363.jpg",
                        "url": "https://ozon.ru",
                        "average_price": 2465,
                        "currency": "rub",
                        "lat": 42.123,
                        "lon": 32.123,
                        "delivery_available": True
                    },
                    {
                        "id": 2,
                        "name": "Лабиринт",
                        "img_url": "https://ozon-st.cdn.ngenix.net/multimedia/1000233363.jpg",
                        "url": "https://www.labirint.ru",
                        "average_price": 2765,
                        "currency": "rub",
                        "lat": 42.123,
                        "lon": 32.123,
                        "delivery_available": True
                    }
                ]
            },
            {
                "type": "best_review",
                "title": "Лучший отзыв",
                "review": [
                    {
                        "id": 1,
                        "author": "Костик Ртуть",
                        "source": "ozon.ru",
                        "summary": "На редкость элегантное издание Тэффи. Приятные на ощупь белые плотные страницы. Хорошая подборка рассказов. Замечательно и остроумно. Книга небольшая, на вечер-другой, но выполнена очень приятно, если сомневаетесь, брать ли — хочу развеять ваши сомнения. Своих денег стоит."
                    }
                ]
            },
            {
                "type": "similar_book",
                "title": "Похожие книги",
                "books": [
                    {
                        "id": "book/2",
                        "type": "book",
                        "title": "Гормоны счастья. Приучите свой мозг вырабатывать",
                        "author": "Бройнинг Лоретта Грациано",
                        "average_price": 2465,
                        "currency": "rub",
                        "rating": 4.5,
                        "img_url": "https://ozon-st.cdn.ngenix.net/multimedia/1000233363.jpg"
                    },
                    {
                        "id": "book/3",
                        "type": "book",
                        "title": "Дизайн привычных вещей",
                        "author": "Норман Дональд",
                        "average_price": 2465,
                        "currency": "rub",
                        "rating": 4.5,
                        "img_url": "https://ozon-st.cdn.ngenix.net/multimedia/1000233363.jpg"
                    },
                    {
                        "id": "book/4",
                        "type": "book",
                        "title": "Психология искусства",
                        "author": "Иржи Кулка",
                        "average_price": 2465,
                        "currency": "rub",
                        "rating": 4.5,
                        "img_url": "https://ozon-st.cdn.ngenix.net/multimedia/1000233363.jpg"
                    }
                ]
            }
        ]
    },
    "person/1": {
        "id": "person/1",
        "type": "person",
        "name": "Григорий Бернгардт",
        "company": "Surf Studio",
        "position": "iOS lead",
        "bio": "Занимаюсь iOS разработкой последние 6 лет. "
               "За это время поработал с большим кол-вом проектов в разного рода компаниях, стартапах, "
               "фрилансе и крупных аутсорсинговых компаниях. "
               "Сейчас возглавляю отдел iOS разработки в небольшой, но классной студии Surf.",
        "website": "http://berngardt.ru",
        "img_url": "https://ozon-st.cdn.ngenix.net/multimedia/1000233363.jpg",
        "details": [
            {
                "type": "person_social_networks",
                "title": "Социальные сети",
                "social_networks": [
                    {
                        "id": 1,
                        "name": "Twitter",
                        "img_url": "https://vignette.wikia.nocookie.net/simpsons/images/1/11/Twitter_bird_icon.png",
                        "url": "https://twitter.com"
                    },
                    {
                        "id": 2,
                        "name": "Instagram",
                        "img_url": "https://vignette.wikia.nocookie.net/riverdalearchie/images/a/a5/Instagram_icon.png",
                        "url": "https://instagram.com"
                    },
                    {
                        "id": 3,
                        "name": "Facebook",
                        "img_url": "http://www.transparentpng.com/thumb/facebook-logo-png/download-facebook-logo-png-18.png",
                        "url": "https://facebook.com"
                    },
                    {
                        "id": 4,
                        "name": "VK",
                        "img_url": "https://cryptocurrency.tech/wp-content/uploads/2017/08/vk.png",
                        "url": "https://vk.com"
                    }
                ]
            }
        ]
    }
}

vectors = {
    'book/1': [0.09930419921875, 3.55859375, 0.9072265625, 0.0, 0.76123046875, 0.1263427734375, 0.98876953125,
               0.250732421875, 0.0, 1.3916015625, 0.0, 0.28076171875, 0.0728759765625, 0.5107421875, 1.75390625,
               1.1220703125, 0.07147216796875, 2.634765625, 0.041778564453125, 2.142578125, 1.1357421875,
               0.038726806640625, 0.0, 0.0, 0.0, 0.1287841796875, 0.9638671875, 1.7880859375, 0.0, 0.0, 0.47998046875,
               0.044036865234375, 1.41015625, 0.028564453125, 1.4267578125, 0.9833984375, 0.0, 0.203125,
               0.1202392578125, 0.60498046875, 0.072265625, 0.10223388671875, 0.130615234375, 0.0, 0.135009765625,
               0.1224365234375, 0.56591796875, 0.06689453125, 1.1767578125, 0.026763916015625, 0.0, 1.7685546875,
               1.369140625, 0.226806640625, 3.537109375, 0.0, 0.166748046875, 0.0, 0.751953125, 0.10791015625, 0.0,
               0.4521484375, 0.0132904052734375, 0.461669921875, 0.17333984375, 0.388671875, 0.0, 0.407470703125,
               1.2861328125, 0.06109619140625, 0.42333984375, 0.00969696044921875, 0.006191253662109375, 0.447265625,
               0.27783203125, 0.07623291015625, 0.54052734375, 1.2783203125, 0.342041015625, 0.0187225341796875,
               0.5595703125, 0.0, 0.052276611328125, 0.0, 1.04296875, 0.011932373046875, 1.396484375, 0.0447998046875,
               0.04302978515625, 0.0, 0.04473876953125, 0.0, 0.0, 0.33154296875, 0.0, 0.916015625, 0.2452392578125,
               0.4453125, 0.029052734375, 0.96142578125, 0.7431640625, 0.0247650146484375, 3.986328125, 0.6318359375,
               0.0, 0.465576171875, 0.1685791015625, 0.189453125, 0.0, 0.74853515625, 2.90625, 2.296875, 0.364013671875,
               0.0234832763671875, 0.56005859375, 0.244873046875, 2.322265625, 0.07843017578125, 0.0, 0.0,
               0.48974609375, 0.0, 0.06402587890625, 0.54736328125, 0.74853515625, 0.393798828125, 0.302001953125,
               0.0535888671875, 1.5146484375, 0.0035915374755859375, 0.67041015625, 0.0, 2.349609375, 0.626953125,
               0.61962890625, 0.0, 0.03271484375, 0.2347412109375, 0.250732421875, 0.0, 0.93359375, 0.14892578125,
               0.1376953125, 0.0077362060546875, 0.8798828125, 0.0, 1.05859375, 0.8154296875, 0.0, 0.0, 0.4755859375,
               0.0, 0.0394287109375, 1.8583984375, 0.0, 0.025970458984375, 0.017730712890625, 0.0, 0.1578369140625,
               0.2391357421875, 0.1043701171875, 2.70703125, 0.84375, 0.1490478515625, 1.2578125, 0.0, 2.326171875,
               0.379150390625, 0.88525390625, 0.06365966796875, 1.578125, 0.191162109375, 0.149169921875, 0.17919921875,
               0.06671142578125, 0.06597900390625, 0.0, 0.01255035400390625, 2.630859375, 0.0, 0.0, 1.6904296875, 0.0,
               0.024444580078125, 4.91796875, 0.0, 0.12890625, 0.9736328125, 0.0919189453125, 0.0, 0.93017578125,
               1.5078125, 0.033203125, 0.86767578125, 0.0, 0.0, 1.19921875, 0.09649658203125, 0.0269927978515625,
               0.86376953125, 1.583984375, 0.77392578125, 0.0, 1.5361328125, 1.2900390625, 0.193115234375, 0.0,
               0.4599609375, 0.0, 0.62109375, 0.254150390625, 0.326416015625, 0.8671875, 0.1270751953125, 1.7529296875,
               0.9287109375, 0.06475830078125, 0.0, 0.415283203125, 0.0, 0.0, 0.149169921875, 1.1435546875, 4.13671875,
               0.0, 0.8955078125, 1.8583984375, 0.2032470703125, 0.10614013671875, 0.299560546875, 0.0, 0.320068359375,
               0.0131378173828125, 0.0, 1.015625, 1.6162109375, 1.53515625, 0.0175933837890625, 1.7509765625,
               1.8349609375, 0.1405029296875, 0.51123046875, 0.0, 0.348876953125, 0.108642578125, 0.67236328125, 0.0,
               0.609375, 0.61328125, 1.669921875, 0.0005121231079101562, 0.0, 0.10791015625, 0.048553466796875,
               0.10760498046875, 0.33642578125, 0.0124053955078125, 0.0, 0.1402587890625, 0.99560546875, 0.0,
               0.02130126953125, 0.493408203125, 0.98681640625, 0.492919921875, 0.00286865234375, 0.360595703125,
               0.88134765625, 0.038543701171875, 0.0, 0.01361846923828125, 0.0, 2.173828125, 0.55419921875, 1.86328125,
               0.0, 0.032440185546875, 0.273681640625, 0.0, 0.0, 0.0, 0.02532958984375, 0.4658203125, 0.0,
               0.0231170654296875, 0.0640869140625, 1.57421875, 0.7431640625, 0.1514892578125, 1.123046875, 2.419921875,
               0.0, 0.30859375, 2.208984375, 0.0599365234375, 0.0, 0.48779296875, 1.1611328125, 0.015777587890625,
               0.0024700164794921875, 0.246826171875, 0.0, 1.2978515625, 1.3603515625, 1.2392578125, 0.0,
               0.354248046875, 0.05010986328125, 0.1610107421875, 0.0, 0.308837890625, 0.45361328125, 0.55908203125,
               0.0, 1.4013671875, 1.7314453125, 0.144775390625, 0.12493896484375, 0.3916015625, 0.07098388671875, 0.0,
               0.00409698486328125, 0.083251953125, 0.371337890625, 0.8203125, 1.5341796875, 1.46875, 0.0,
               0.10491943359375, 0.47802734375, 0.29248046875, 0.06268310546875, 3.150390625, 0.435791015625,
               1.2158203125, 0.0190582275390625, 0.62255859375, 0.21435546875, 0.498291015625, 0.0, 0.08331298828125,
               0.0, 0.80517578125, 0.0, 2.1484375, 0.236572265625, 0.1949462890625, 1.373046875, 0.07012939453125, 0.0,
               1.3017578125, 0.0, 0.0, 0.08551025390625, 1.0693359375, 0.002193450927734375, 0.54345703125,
               0.97998046875, 0.00568389892578125, 0.80859375, 0.21923828125, 0.3359375, 0.19287109375, 1.5205078125,
               0.0, 0.1092529296875, 1.5439453125, 0.953125, 1.8681640625, 0.88037109375, 0.87841796875, 0.94873046875,
               0.748046875, 0.359130859375, 0.1982421875, 0.1572265625, 0.49267578125, 0.86767578125, 0.0, 1.4169921875,
               0.0, 0.3193359375, 1.849609375, 0.07861328125, 0.0011320114135742188, 0.256103515625, 1.037109375, 0.0,
               0.12017822265625, 0.168212890625, 0.0, 1.2060546875, 2.244140625, 0.003032684326171875, 0.08709716796875,
               0.28857421875, 0.016937255859375, 0.0219573974609375, 0.0556640625, 1.1552734375, 0.5341796875,
               0.1278076171875, 1.26171875, 0.9501953125, 0.0, 0.0731201171875, 2.515625, 0.048248291015625,
               0.81884765625, 0.09423828125, 1.37109375, 0.3818359375, 0.73779296875, 0.31591796875, 0.35498046875,
               0.1575927734375, 0.08331298828125, 1.3583984375, 0.290771484375, 0.00952911376953125, 0.72265625,
               0.387939453125, 1.2958984375, 0.318115234375, 0.499755859375, 1.8251953125, 1.69921875, 0.66015625,
               0.05828857421875, 0.1082763671875, 0.0240936279296875, 0.57470703125, 2.73046875, 1.2060546875,
               0.053314208984375, 1.384765625, 2.53515625, 0.322021484375, 0.09503173828125, 0.53271484375, 1.376953125,
               2.068359375, 0.2120361328125, 1.099609375, 0.0, 0.10455322265625, 0.95361328125, 0.005340576171875,
               0.1513671875, 0.0, 0.2274169921875, 1.775390625, 0.0, 0.06097412109375, 0.01045989990234375, 0.0, 0.0,
               1.63671875, 1.892578125, 2.4765625, 0.0, 0.0, 0.453857421875, 2.50390625, 0.1678466796875,
               0.184326171875, 0.50048828125, 0.0814208984375, 0.0038509368896484375, 2.337890625, 0.0, 2.173828125,
               0.0, 0.0, 0.12646484375, 3.291015625, 0.45654296875, 2.078125, 1.916015625, 1.0537109375, 1.22265625,
               0.1187744140625, 0.0018644332885742188, 0.73095703125, 0.2130126953125, 0.428955078125,
               0.039825439453125, 1.181640625, 0.22119140625, 1.53515625, 0.0, 0.14697265625, 0.08282470703125,
               0.321044921875, 0.428466796875, 0.6884765625, 0.02032470703125, 0.79541015625, 0.115478515625,
               0.220458984375, 0.55859375, 0.0, 0.0, 0.32275390625, 0.966796875, 0.77587890625, 0.39990234375,
               0.160400390625, 0.0, 0.426513671875, 0.403564453125, 2.24609375, 0.0, 0.0, 0.0, 0.52294921875, 0.0,
               2.1640625, 0.04541015625, 0.300048828125, 0.0130767822265625, 0.2890625, 0.1197509765625, 0.0,
               1.6611328125, 0.0, 0.69189453125, 0.0, 0.01020050048828125, 1.517578125, 0.26416015625, 0.71533203125,
               0.0, 0.0, 0.0, 0.0, 0.5048828125, 0.01215362548828125, 0.0, 2.74609375, 0.0, 1.0185546875, 0.8017578125,
               0.2890625, 0.321533203125, 0.67431640625, 0.1312255859375, 1.3564453125, 0.2252197265625, 0.265380859375,
               0.054412841796875, 1.2421875, 0.19580078125, 1.142578125, 0.385986328125, 0.06463623046875, 0.5341796875,
               0.2169189453125, 0.8603515625, 0.048675537109375, 0.0, 0.1181640625, 0.06201171875, 0.0, 0.0,
               0.22412109375, 0.0, 0.0, 1.1142578125, 0.40087890625, 0.0286865234375, 0.2626953125, 0.70068359375, 0.0,
               0.401611328125, 0.0, 0.2008056640625, 0.495361328125, 0.35888671875, 0.0, 0.97216796875, 1.93359375, 0.0,
               0.11480712890625, 0.8369140625, 0.00818634033203125, 1.0126953125, 0.2061767578125, 0.07672119140625,
               0.0, 1.224609375, 0.3369140625, 0.1123046875, 1.125, 0.15771484375, 0.2548828125, 1.98828125, 1.4296875,
               0.0168304443359375, 0.01401519775390625, 0.1578369140625, 0.677734375, 1.091796875, 1.1943359375, 0.0,
               0.044677734375, 0.202880859375, 2.33203125, 0.0, 0.123291015625, 0.046173095703125, 2.935546875,
               0.400146484375, 0.185302734375, 0.334716796875, 0.1683349609375, 0.890625, 0.0, 0.00890350341796875, 0.0,
               0.46826171875, 0.281005859375, 1.6171875, 4.32421875, 1.8349609375, 0.11138916015625, 2.01953125,
               0.06304931640625, 0.1357421875, 0.0, 0.0201873779296875, 0.248779296875, 0.0200653076171875,
               0.1414794921875, 0.1614990234375, 2.01953125, 0.0, 0.0, 1.92578125, 0.3798828125, 0.309814453125,
               0.45361328125, 0.307861328125, 0.689453125, 0.0, 0.0056915283203125, 0.29345703125, 0.06927490234375,
               0.70751953125, 2.140625, 2.115234375, 0.0, 0.100341796875, 0.242431640625, 0.81005859375, 0.0, 0.0,
               0.59912109375, 1.0146484375, 0.0, 0.78955078125, 0.59375, 0.92919921875, 0.0, 1.390625, 0.0413818359375,
               0.491455078125, 0.130126953125, 0.481689453125, 1.01953125, 1.0244140625, 0.78662109375, 0.93798828125,
               0.91943359375, 0.3935546875, 0.0, 0.182861328125, 1.0888671875, 0.044464111328125, 0.2103271484375, 0.0,
               0.58349609375, 0.0, 1.0419921875, 0.0098724365234375, 0.031585693359375, 0.88232421875, 0.1285400390625,
               0.0, 0.30224609375, 2.013671875, 0.02496337890625, 0.2120361328125, 0.50732421875, 0.0121307373046875,
               0.7060546875, 0.118408203125, 1.60546875, 0.0, 0.22265625, 0.01241302490234375, 0.346923828125,
               0.99658203125, 0.5966796875, 0.0, 1.19921875, 2.53125, 2.560546875, 0.51123046875, 0.25341796875,
               0.032806396484375, 0.0770263671875, 0.56591796875, 0.0828857421875, 0.089599609375, 2.05859375,
               1.7353515625, 0.0, 0.46337890625, 0.293701171875, 0.14697265625, 0.26953125, 0.16357421875, 4.35546875,
               0.64111328125, 0.2137451171875, 0.0897216796875, 0.11138916015625, 0.145263671875, 0.01161956787109375,
               0.2423095703125, 0.466064453125, 1.00390625, 0.05792236328125, 0.63671875, 0.4287109375, 0.57470703125,
               0.73291015625, 2.72265625, 0.94482421875, 1.2939453125, 0.1883544921875, 1.1298828125, 0.0,
               0.50830078125, 0.008209228515625, 0.047332763671875, 0.646484375, 2.974609375, 0.24755859375, 0.0,
               0.99462890625, 0.7861328125, 0.0, 0.0, 1.736328125, 0.344482421875, 1.91015625, 0.0, 0.7490234375,
               0.09808349609375, 0.0, 1.3515625, 2.60546875, 0.1861572265625, 0.1500244140625, 0.69482421875,
               0.1798095703125, 1.421875, 0.0423583984375, 0.0, 0.060089111328125, 0.71484375, 0.362060546875,
               0.07122802734375, 1.4912109375, 0.44384765625, 0.417724609375, 0.32373046875, 0.1302490234375,
               1.552734375, 0.037200927734375, 0.01788330078125, 1.9052734375, 0.1644287109375, 0.798828125,
               0.65478515625, 0.477294921875, 2.267578125, 0.493408203125, 0.0, 0.0, 0.0, 0.017822265625,
               0.216064453125, 1.048828125, 1.2373046875, 0.98779296875, 0.4189453125, 3.59375, 0.517578125,
               0.0156097412109375, 0.34814453125, 2.765625, 0.107666015625, 0.0, 0.0278472900390625, 0.04345703125,
               0.399169921875, 0.2724609375, 0.56396484375, 1.4482421875, 0.09112548828125, 0.0, 1.291015625,
               0.017181396484375, 0.76513671875, 0.0, 0.6025390625, 1.1337890625, 0.13525390625, 1.537109375,
               2.396484375, 3.833984375, 0.0, 0.5791015625, 1.33984375, 0.4521484375, 0.191162109375, 0.5078125,
               1.06640625, 0.1805419921875, 0.2314453125, 0.44189453125, 0.18603515625, 0.57275390625, 1.2197265625,
               0.1439208984375, 0.5498046875, 0.112548828125, 3.34765625, 1.623046875, 0.2320556640625,
               0.04022216796875, 0.90625, 0.84716796875, 0.1585693359375, 0.007137298583984375, 0.12042236328125,
               1.29296875, 0.08544921875, 0.2227783203125, 0.00519561767578125, 1.2607421875, 0.1103515625,
               0.1561279296875, 2.439453125, 1.6376953125, 0.0697021484375, 0.155517578125, 0.00684356689453125, 0.0,
               0.06878662109375, 1.7197265625, 2.396484375, 0.399658203125, 0.703125, 0.167236328125, 0.826171875,
               0.1990966796875, 0.384033203125, 0.324462890625, 0.0, 0.0418701171875, 0.054931640625, 0.60791015625,
               0.061370849609375, 0.5849609375, 0.0, 2.08984375, 0.1787109375, 0.29443359375, 0.73095703125,
               0.53857421875, 0.048309326171875, 4.0546875, 0.0, 0.53955078125, 0.348876953125, 0.0, 0.0, 0.43994140625,
               0.0, 0.037506103515625, 0.0, 0.0, 0.0, 0.215576171875, 0.70458984375, 1.2900390625, 0.1221923828125,
               0.0267791748046875, 1.0791015625, 0.04046630859375, 0.0, 1.6796875, 0.2100830078125, 0.322998046875, 0.0,
               3.890625, 0.032623291015625, 0.1357421875, 0.3388671875, 0.021575927734375, 0.41552734375, 2.435546875,
               0.8818359375, 1.1025390625, 0.0197296142578125, 0.2440185546875, 0.351318359375, 0.271728515625,
               0.71923828125, 0.0, 0.255126953125, 1.306640625, 0.1556396484375, 0.284912109375, 0.7333984375, 0.0,
               1.978515625, 0.10467529296875, 0.0, 0.396728515625, 0.0, 0.0, 0.413818359375, 0.048248291015625,
               0.05535888671875, 0.1986083984375, 0.03076171875, 2.064453125, 0.0, 0.20166015625, 0.0, 0.05889892578125,
               0.135986328125, 1.9658203125, 0.46728515625, 0.0, 1.0751953125, 0.0, 0.06011962890625, 0.272216796875,
               0.52978515625, 2.1953125, 0.051116943359375, 0.99853515625, 0.0, 0.8779296875, 0.0, 0.80078125, 1.578125,
               0.037994384765625, 0.0, 0.0, 1.3369140625, 0.2257080078125, 0.054473876953125, 0.06121826171875,
               0.59912109375, 1.01171875, 0.0599365234375, 1.2626953125, 1.494140625, 0.658203125, 0.5302734375,
               0.02838134765625, 3.119140625, 1.4658203125, 1.736328125, 0.681640625, 0.0301666259765625, 0.900390625,
               0.361572265625, 1.5224609375, 0.0092620849609375, 1.15234375, 0.0, 0.685546875, 3.548828125,
               0.28173828125, 0.311767578125, 0.266845703125, 0.92236328125, 0.0, 0.1414794921875, 0.0183563232421875,
               0.0, 0.12042236328125, 0.047576904296875, 1.185546875, 0.0205535888671875, 0.0, 0.024444580078125,
               0.489501953125, 0.1422119140625, 0.10565185546875, 1.837890625, 0.0, 0.11444091796875, 0.82861328125,
               0.0, 2.212890625, 0.032318115234375, 0.490966796875, 0.1298828125, 0.1617431640625, 0.3046875,
               0.307861328125, 1.7626953125, 0.01523590087890625, 0.5498046875, 0.10174560546875],
    'person/1': [0.60009765625, 0.397705078125, 2.505859375, 0.249267578125, 0.16845703125, 0.5751953125,
                 0.474365234375, 0.0075225830078125, 3.521484375, 0.724609375, 0.8671875, 0.0830078125, 0.240966796875,
                 0.290283203125, 1.056640625, 1.1328125, 1.4091796875, 4.0390625, 0.42333984375, 0.0, 0.0,
                 0.10302734375, 0.356201171875, 1.111328125, 0.374755859375, 0.4599609375, 2.23046875, 1.5888671875,
                 0.0, 0.0, 2.16796875, 1.8818359375, 0.0, 0.0833740234375, 0.5048828125, 0.83935546875, 0.400390625,
                 2.533203125, 0.024658203125, 0.205078125, 0.357421875, 1.564453125, 0.7734375, 0.051513671875,
                 0.465576171875, 0.06903076171875, 0.0245819091796875, 0.1065673828125, 0.896484375, 0.0,
                 0.01739501953125, 0.0, 0.246337890625, 1.6484375, 1.43359375, 0.66015625, 0.176513671875, 0.0, 0.0,
                 0.197021484375, 0.221435546875, 0.1171875, 0.1259765625, 0.1732177734375, 0.0, 1.7958984375,
                 0.049102783203125, 0.5703125, 0.07373046875, 0.068359375, 0.041748046875, 2.0078125,
                 0.00522613525390625, 0.331298828125, 0.0, 0.054229736328125, 0.138671875, 0.331787109375,
                 0.101806640625, 1.0, 0.06854248046875, 0.5498046875, 1.1611328125, 0.1611328125, 0.84130859375, 0.0,
                 0.0, 0.3095703125, 0.002910614013671875, 2.244140625, 0.008087158203125, 0.5625, 0.0, 0.55615234375,
                 0.0, 0.0, 0.9560546875, 2.609375, 0.165283203125, 0.14599609375, 1.10546875, 0.37548828125,
                 0.450927734375, 2.296875, 2.626953125, 1.3828125, 0.580078125, 0.0, 0.0, 0.30517578125, 0.0,
                 0.11029052734375, 1.0771484375, 0.736328125, 0.037689208984375, 0.153564453125, 0.1307373046875,
                 1.5263671875, 0.02471923828125, 0.464599609375, 0.2445068359375, 0.1309814453125, 0.9638671875,
                 1.4677734375, 0.0, 0.0, 1.38671875, 2.90625, 1.1220703125, 0.08282470703125, 2.681640625,
                 0.76416015625, 0.0, 2.259765625, 0.0, 0.087158203125, 0.0, 2.125, 0.2171630859375, 0.1973876953125,
                 0.049224853515625, 0.59814453125, 0.00389862060546875, 0.0, 0.161376953125, 0.232177734375, 0.0,
                 0.127197265625, 0.0614013671875, 0.0, 0.0, 0.603515625, 0.20361328125, 0.1666259765625, 1.97265625,
                 2.029296875, 0.0227813720703125, 0.351806640625, 0.69091796875, 0.0, 0.8212890625, 0.0,
                 0.1417236328125, 0.0, 0.9072265625, 0.3857421875, 0.0, 0.0, 0.486328125, 0.6298828125,
                 0.011444091796875, 0.70166015625, 0.0, 0.002796173095703125, 1.05859375, 0.01535797119140625, 0.0, 0.0,
                 0.0, 0.0098419189453125, 0.81591796875, 0.051971435546875, 0.0150299072265625, 0.0049591064453125,
                 2.6796875, 0.77880859375, 0.022735595703125, 0.0, 0.029296875, 1.736328125, 1.787109375, 0.0,
                 0.306884765625, 0.20458984375, 0.08367919921875, 0.483154296875, 2.107421875, 0.79052734375, 0.0, 0.0,
                 0.09783935546875, 0.78759765625, 0.08935546875, 0.353759765625, 0.43994140625, 0.1533203125,
                 0.001316070556640625, 0.324462890625, 0.0, 0.0877685546875, 0.38330078125, 0.0, 0.5146484375,
                 0.2568359375, 0.225341796875, 0.0120086669921875, 0.81982421875, 0.12261962890625, 0.1622314453125,
                 1.80859375, 0.0, 0.0, 0.97314453125, 0.04193115234375, 0.2476806640625, 0.7021484375, 0.0, 0.0,
                 0.1065673828125, 0.11572265625, 0.21875, 1.447265625, 0.0, 0.147216796875, 0.5361328125,
                 0.088134765625, 0.0, 0.0, 0.572265625, 0.0, 0.8505859375, 0.256103515625, 0.0, 0.572265625,
                 0.78955078125, 0.0526123046875, 0.0221710205078125, 0.360595703125, 0.0, 1.16796875, 0.1949462890625,
                 0.6708984375, 0.64013671875, 0.0, 0.0, 0.43359375, 0.10369873046875, 0.6591796875, 0.4775390625,
                 0.1336669921875, 1.3564453125, 1.4482421875, 0.3369140625, 0.0, 0.0, 0.35888671875, 0.2900390625,
                 0.321044921875, 1.73828125, 0.6787109375, 1.208984375, 0.21142578125, 0.043609619140625, 0.0,
                 1.87109375, 0.67333984375, 0.60400390625, 0.51416015625, 0.01898193359375, 0.0, 0.60693359375,
                 0.353759765625, 0.59228515625, 0.0, 0.8505859375, 0.3173828125, 0.642578125, 0.0, 0.451416015625,
                 0.06329345703125, 1.126953125, 0.0, 0.0, 0.5029296875, 1.20703125, 0.88525390625, 0.031982421875,
                 0.888671875, 0.273193359375, 1.6484375, 0.07562255859375, 0.1893310546875, 0.443603515625, 0.603515625,
                 0.09967041015625, 0.0, 1.423828125, 0.0, 0.07989501953125, 1.45703125, 0.283935546875, 0.440185546875,
                 0.1802978515625, 2.08984375, 0.3388671875, 0.138671875, 0.497802734375, 0.0306396484375,
                 0.09259033203125, 0.57568359375, 0.0, 1.1982421875, 0.3935546875, 1.0966796875, 0.0633544921875,
                 0.055908203125, 0.0150146484375, 0.00965118408203125, 0.06103515625, 0.04718017578125, 0.58544921875,
                 0.023773193359375, 0.0, 0.7529296875, 0.1624755859375, 0.06292724609375, 0.0, 0.07965087890625, 0.0,
                 0.0, 0.32275390625, 0.0, 0.01274871826171875, 0.91650390625, 1.046875, 0.0, 0.5634765625,
                 0.1710205078125, 0.98193359375, 0.2005615234375, 1.1572265625, 0.006778717041015625, 1.0986328125, 0.0,
                 0.1346435546875, 0.60986328125, 1.3642578125, 0.85009765625, 0.42236328125, 0.2401123046875, 1.109375,
                 0.0004551410675048828, 0.2158203125, 0.76611328125, 0.0, 0.2127685546875, 0.2073974609375, 0.357421875,
                 0.0, 0.0205841064453125, 0.06903076171875, 1.2021484375, 1.640625, 0.0, 0.0, 0.08172607421875,
                 0.486328125, 0.0550537109375, 0.0, 0.1014404296875, 1.2109375, 0.0550537109375, 0.7724609375,
                 0.01319122314453125, 0.0158233642578125, 0.603515625, 0.1412353515625, 1.5498046875, 0.0, 1.7734375,
                 0.0792236328125, 0.712890625, 0.0, 0.19384765625, 0.78369140625, 1.115234375, 0.0, 0.9169921875,
                 1.2236328125, 0.0, 0.1829833984375, 0.254150390625, 0.46484375, 0.59375, 0.00934600830078125, 0.0, 0.0,
                 0.0, 1.3486328125, 0.94970703125, 0.51513671875, 2.376953125, 0.2139892578125, 0.419189453125,
                 0.74609375, 0.3896484375, 0.0, 0.31591796875, 1.1416015625, 0.0009074211120605469, 0.0,
                 0.1917724609375, 0.62744140625, 0.00646209716796875, 0.58642578125, 0.884765625, 0.6220703125,
                 0.352294921875, 0.24169921875, 0.0, 0.0, 0.36962890625, 0.358154296875, 0.312744140625,
                 0.0977783203125, 0.04473876953125, 0.5537109375, 0.1036376953125, 0.0, 0.07958984375, 0.309326171875,
                 0.1688232421875, 0.9345703125, 0.44189453125, 0.0, 0.04052734375, 0.293701171875, 0.0,
                 0.045989990234375, 0.037841796875, 0.02520751953125, 0.11676025390625, 0.437255859375, 0.79345703125,
                 0.051605224609375, 0.0, 1.0869140625, 0.207763671875, 2.791015625, 0.463623046875, 1.671875,
                 0.0071868896484375, 0.070068359375, 0.78466796875, 0.09844970703125, 1.6025390625, 1.505859375,
                 0.9912109375, 0.101806640625, 0.10894775390625, 0.20849609375, 0.408447265625, 0.0, 0.0, 2.642578125,
                 2.1484375, 0.53857421875, 0.03155517578125, 0.0, 2.470703125, 0.0030002593994140625, 0.1998291015625,
                 0.0, 0.117919921875, 0.0462646484375, 0.0, 0.01297760009765625, 0.24755859375, 0.6298828125,
                 0.55078125, 0.146240234375, 0.444091796875, 0.3330078125, 0.0, 0.173095703125, 0.0, 0.042205810546875,
                 2.306640625, 1.4482421875, 0.26416015625, 1.3603515625, 0.0, 0.0, 0.44189453125, 0.1207275390625,
                 0.0014743804931640625, 0.212158203125, 0.0, 0.0, 0.0, 0.0248870849609375, 1.064453125,
                 0.006565093994140625, 1.712890625, 0.0, 0.18017578125, 0.1876220703125, 2.4375, 0.65234375, 0.0, 0.0,
                 0.97216796875, 0.0, 1.44921875, 0.04376220703125, 0.00803375244140625, 0.66748046875, 1.01953125,
                 0.89453125, 0.08197021484375, 0.23583984375, 0.09075927734375, 0.02032470703125, 0.0994873046875,
                 1.1669921875, 2.064453125, 0.93115234375, 0.33740234375, 0.0168914794921875, 0.1629638671875,
                 0.45361328125, 0.1934814453125, 0.0897216796875, 0.4990234375, 0.09381103515625, 0.233154296875,
                 0.064208984375, 2.3515625, 0.335693359375, 0.125, 0.0, 0.0, 0.0384521484375, 4.078125,
                 0.03192138671875, 0.5390625, 0.8837890625, 0.0, 1.5380859375, 0.0203857421875, 0.2188720703125,
                 0.15283203125, 1.79296875, 1.9755859375, 0.474365234375, 0.0, 0.073486328125, 0.1484375, 0.3994140625,
                 0.469970703125, 0.073486328125, 0.01143646240234375, 0.3525390625, 0.161865234375, 1.814453125, 0.0,
                 0.271240234375, 0.0230865478515625, 0.301025390625, 0.39990234375, 0.0, 0.04888916015625, 0.5498046875,
                 0.0, 0.0, 0.0780029296875, 1.1123046875, 0.634765625, 0.041473388671875, 2.744140625, 1.0283203125,
                 0.2166748046875, 0.0279998779296875, 0.57177734375, 0.0, 0.2489013671875, 0.24560546875, 0.603515625,
                 0.11798095703125, 1.3310546875, 0.45654296875, 0.0, 0.0, 0.1640625, 0.1793212890625, 0.0,
                 0.1546630859375, 0.57080078125, 0.0037708282470703125, 0.9033203125, 2.130859375, 0.5615234375,
                 0.7431640625, 0.634765625, 3.5703125, 0.257080078125, 1.8828125, 0.0, 0.6064453125, 0.32470703125,
                 0.0069732666015625, 0.62939453125, 1.82421875, 2.94921875, 0.25927734375, 0.5927734375,
                 0.1197509765625, 0.156982421875, 0.1568603515625, 0.62353515625, 0.006748199462890625, 0.0,
                 2.400390625, 1.3037109375, 0.1234130859375, 0.0, 0.6552734375, 0.0, 0.029449462890625, 0.39453125,
                 0.1412353515625, 0.013519287109375, 1.0712890625, 1.1884765625, 0.88525390625, 0.0, 0.11224365234375,
                 0.060638427734375, 0.87353515625, 0.1727294921875, 0.07574462890625, 0.0, 0.0, 0.25341796875, 0.0,
                 2.0390625, 0.427734375, 0.52001953125, 0.38134765625, 0.380126953125, 1.1015625, 0.1866455078125, 0.0,
                 0.470703125, 0.0239410400390625, 0.364990234375, 0.1348876953125, 0.09759521484375, 0.0,
                 0.439208984375, 0.126220703125, 0.27587890625, 0.058624267578125, 0.08563232421875, 0.0145721435546875,
                 0.1112060546875, 4.07421875, 0.389892578125, 0.2064208984375, 0.93505859375, 0.055419921875, 2.1171875,
                 0.250732421875, 0.452880859375, 1.6416015625, 0.00522613525390625, 0.0, 0.73095703125, 0.7314453125,
                 0.0, 1.875, 0.5390625, 0.63720703125, 0.76513671875, 0.837890625, 0.43310546875, 0.56201171875,
                 0.2276611328125, 0.34619140625, 0.299072265625, 0.041656494140625, 0.06756591796875, 1.1484375,
                 0.0784912109375, 0.0, 0.31689453125, 0.0289306640625, 0.43505859375, 1.005859375, 0.10443115234375,
                 0.28466796875, 0.0850830078125, 0.287109375, 0.052215576171875, 0.0, 0.630859375, 0.062408447265625,
                 1.7587890625, 0.9912109375, 0.0, 0.007755279541015625, 0.448974609375, 0.123291015625, 0.81982421875,
                 0.018310546875, 1.0576171875, 1.5849609375, 0.197998046875, 0.0, 0.9638671875, 0.0, 0.2822265625,
                 1.822265625, 0.0, 0.8154296875, 0.2115478515625, 1.64453125, 0.2220458984375, 0.169921875,
                 0.5908203125, 0.1949462890625, 0.275146484375, 0.2325439453125, 0.95751953125, 0.22265625, 0.259765625,
                 0.460693359375, 0.0, 0.307861328125, 0.498779296875, 0.083740234375, 1.25, 0.2088623046875,
                 0.662109375, 0.409912109375, 0.0777587890625, 0.06805419921875, 1.0380859375, 1.7265625, 0.75537109375,
                 0.0, 0.0, 0.142333984375, 0.0, 0.153076171875, 0.0, 0.0, 0.2281494140625, 0.0, 0.0, 0.99755859375, 0.0,
                 0.0, 0.28125, 0.0, 1.099609375, 0.1558837890625, 0.11151123046875, 0.061279296875, 1.3525390625,
                 0.019134521484375, 0.78857421875, 1.771484375, 0.34716796875, 0.050689697265625, 0.232421875,
                 0.017333984375, 2.267578125, 0.130126953125, 0.275146484375, 0.2353515625, 0.052093505859375,
                 0.033721923828125, 0.0709228515625, 0.0038547515869140625, 0.06280517578125, 3.51953125, 0.0, 0.0,
                 0.79638671875, 0.0, 0.66845703125, 0.0, 0.0, 0.0531005859375, 0.002002716064453125, 0.634765625,
                 0.9072265625, 0.131103515625, 0.1864013671875, 0.049072265625, 0.0, 1.9794921875, 1.24609375,
                 1.0126953125, 0.3134765625, 1.0634765625, 0.352294921875, 0.35107421875, 0.787109375, 0.0,
                 0.0045166015625, 0.0816650390625, 0.0, 2.76171875, 0.0888671875, 0.83740234375, 0.1268310546875,
                 0.034271240234375, 0.061431884765625, 0.0, 0.08648681640625, 2.615234375, 0.2294921875, 1.7890625,
                 0.06524658203125, 1.1484375, 0.0073089599609375, 0.0, 0.0112152099609375, 0.010284423828125,
                 0.1907958984375, 1.0009765625, 0.62646484375, 0.0, 0.006805419921875, 0.2340087890625, 0.0,
                 0.75244140625, 0.083740234375, 0.0, 0.53759765625, 0.01263427734375, 0.71240234375, 0.0,
                 0.370361328125, 0.01248931884765625, 1.2509765625, 2.126953125, 0.0, 0.63916015625, 0.51123046875, 0.0,
                 0.162109375, 0.377685546875, 0.334228515625, 0.273681640625, 1.45703125, 0.0205841064453125,
                 0.05535888671875, 0.4912109375, 0.318115234375, 0.275390625, 0.85546875, 0.60546875, 0.0, 1.4912109375,
                 2.8828125, 0.254638671875, 0.0, 0.71923828125, 0.78515625, 0.87548828125, 0.85302734375,
                 0.06707763671875, 1.046875, 0.060302734375, 0.548828125, 2.861328125, 0.82080078125,
                 0.00936126708984375, 0.4462890625, 0.04302978515625, 0.458251953125, 0.1544189453125,
                 0.00939178466796875, 0.226806640625, 1.318359375, 0.1741943359375, 0.88037109375, 0.0,
                 0.0164337158203125, 3.2890625, 0.35791015625, 1.126953125, 1.1044921875, 1.0439453125,
                 0.019073486328125, 0.00588226318359375, 1.478515625, 0.0728759765625, 0.0168304443359375,
                 0.03753662109375, 0.71435546875, 0.0023212432861328125, 0.03570556640625, 0.340087890625,
                 0.237060546875, 0.035980224609375, 0.86474609375, 0.2568359375, 0.264404296875, 0.449951171875,
                 0.0009503364562988281, 0.28125, 1.7431640625, 0.0572509765625, 0.329345703125, 0.0304718017578125,
                 0.0791015625, 0.473876953125, 0.12017822265625, 0.0064544677734375, 2.650390625, 3.39453125,
                 1.4912109375, 0.0, 0.1326904296875, 0.7568359375, 0.0, 0.7470703125, 1.3251953125, 0.2412109375, 0.0,
                 0.004116058349609375, 0.1834716796875, 0.69775390625, 0.81982421875, 0.04388427734375, 0.0,
                 2.310546875, 0.37109375, 0.87890625, 1.603515625, 0.0, 0.0, 0.1912841796875, 0.320556640625,
                 0.23974609375, 2.517578125, 0.327392578125, 0.6123046875, 0.0, 0.1114501953125, 0.011260986328125,
                 1.974609375, 0.1868896484375, 0.91845703125, 0.414306640625, 0.55517578125, 0.485595703125,
                 0.040069580078125, 0.017913818359375, 0.953125, 0.0, 0.0, 1.599609375, 0.0, 0.00665283203125,
                 0.023223876953125, 0.1522216796875, 0.1893310546875, 0.0, 0.29541015625, 0.52734375, 0.73876953125,
                 0.278076171875, 0.072998046875, 1.1650390625, 0.0, 0.430908203125, 0.0, 0.036529541015625, 0.0,
                 0.0287322998046875, 0.047607421875, 0.27001953125, 0.927734375, 0.03192138671875, 0.38232421875,
                 0.0194549560546875, 0.0, 0.012115478515625, 1.13671875, 0.256103515625, 0.0155029296875, 0.44140625,
                 0.6484375, 0.0, 0.0789794921875, 0.07196044921875, 0.29296875, 0.888671875, 0.0, 1.80078125,
                 0.06304931640625, 0.15478515625, 1.4970703125, 0.392578125, 0.024383544921875, 1.11328125, 1.609375,
                 0.0, 0.06048583984375]

}


#######

def cos_sim(a, b):
    return dot(a, b) / (norm(a) * norm(b))


@api.route("/search", methods=['POST'])
def search():
    data = request.data
    data_dict = json.loads(data)

    query_vec = data_dict['vec']

    results = [(product_id, cos_sim(query_vec, vec)) for product_id, vec in vectors.items()]

    print(results)

    best_product_id, accuracy = sorted(results, key=lambda a: a[1])[-1]

    if best_product_id in products:
        result = products[best_product_id]
        result["accuracy"] = accuracy
    else:
        abort(404, message="Product not found")

    return jsonify({
        "result": result
    })
